pipeline {
    agent any

    triggers {
        pollSCM('H/5 * * * *')
    }

    environment {
        BRANCH_NAME = "${env.BRANCH_NAME}"
    }

    stages {
        stage('Clone Repository') {
            steps {
                checkout scm
            }
        }
        stage('Print Branch Name') {
            steps {
                echo "Building branch: ${env.BRANCH_NAME}"
            }
        }
        stage('Build and Test') {
            when {
                anyOf {
                    branch 'dev'
                    branch 'staging'
                }
            }
            steps {
                script {
                    if (env.BRANCH_NAME == 'dev') {
                        echo "Running build for the dev branch"
                        // Add dev branch-specific build steps here
                    } else if (env.BRANCH_NAME == 'staging') {
                        echo "Running build for the staging branch"
                        // Add staging branch-specific build steps here
                    }
                }
            }
        }
    }

    post {
        always {
            echo "Finished building branch: ${env.BRANCH_NAME}"
        }
        success {
            echo "Build succeeded for branch: ${env.BRANCH_NAME}"
        }
        failure {
            echo "Build failed for branch: ${env.BRANCH_NAME}"
        }
    }
}
